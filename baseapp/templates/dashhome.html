{% extends 'newbase.html' %}
{% block title %}IBM Sprint Tools{% endblock %}
{% block content %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<br>
<!-- Begin Page Content -->
<div class="container-fluid">
    <!-- Page Heading -->
    <div class="d-sm-flex align-items-center justify-content-between mb-4">
        <h1 class="h3 mb-0 text-gray-800">Report for week {{ week }}</h1>
        <a href="{{ url_for('notify', week=week) }}" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm">Send Notification</a>
    </div>
    <!-- Content Row -->
    <div class="row">
        <div class="col">
            <div class="row">

                <!-- CTE Card -->
                <div class="col mb-4">
                    <div class="card border-left-primary shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">CTE Total hours</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800">{{ ctetotal }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ILC Card -->
                <div class="col mb-4">
                    <div class="card border-left-success shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-success text-uppercase mb-1">ILC Total hours</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800">{{ ilctotal }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <!-- Variance Card -->
                <div class="col mb-4">
                    <div class="card border-left-info shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-info text-uppercase mb-1">Total Variance</div>
                                    <div class="row no-gutters align-items-center">
                                        <div class="col-auto">
                                            <div class="h5 mb-0 mr-3 font-weight-bold text-gray-800"><a href={{ url_for('hours',week=week) }}>{{ vtotal }}</a></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- People with errors -->
                <div class="col mb-4">
                    <div class="card border-left-warning shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">Notes</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800"><a href={{ url_for('errors', week=week) }}>{{ errors }}</a></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col mb-4">
                    <div class="card border-left-info shadow py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-info text-uppercase mb-1"></div>
                                    <div class="row no-gutters align-items-center">
                                        <div class="col-auto">
                                            <ul class="list-group">
                                                <li class="list-group-item"><div class="h5 mb-0 mr-3 font-weight-bold text-gray-800"><a href="{{ url_for('variance', week=week)}}">Variance Table</a></div></li>
                                                <li class="list-group-item"><div class="h5 mb-0 mr-3 font-weight-bold text-gray-800"><a href="{{ url_for('errors', week=week)}}">Errors Table</a></div></li>
                                                <li class="list-group-item"><div class="h5 mb-0 mr-3 font-weight-bold text-gray-800"><a href="{{ url_for('upload', week=week)}}">Files</a></div></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Pie Chart -->
        <div class="col">
            <div class="card shadow mb-4">
                <!-- Card Header - Dropdown -->
                <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                    <h6 class="m-0 font-weight-bold text-primary">{{ legend }}</h6>
                </div>
                <!-- Card Body -->
                <div class="card-body">
                    <div class="pt-4 pb-2">
                        <canvas id="myChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- /.container-fluid -->
<script>
const data = {
    labels: [{% for item in labels %}
             "{{item}}",
            {% endfor %}],
    datasets: [{
      data: [{% for item in values %}
             "{{item}}",
            {% endfor %}],
      backgroundColor: [{% for i in range(15) %}
             "{{ colors[i] }}",
            {% endfor %}],
      hoverBorderColor: "rgba(234, 236, 244, 1)",
    }],
  };

const config = {
  type: 'doughnut',
  data: data,
};

  var myChart = new Chart(
    document.getElementById('myChart'),
    config
  );
</script>

{% endblock %}
